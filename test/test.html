<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>tincan.js - tests</title>
<link href="qunit.css" rel="stylesheet" type="text/css" media="screen"/>
<script src="qunit.js"></script>
<script src="../src/tincan.js"></script>
<script>

test('the basics', function() {
    ok(tincan);
    ok(tincan.publish);
    ok(tincan.subscribe);
});

test('basic pubsub', function() {
    var firstReceived = false,
        secondReceived = false,
        result;

    result = tincan.subscribe('foo', {});
    ok(!result);

    result = tincan.subscribe('foo', null);
    ok(!result);

    result = tincan.subscribe('foo', 1);
    ok(!result);

    result = tincan.subscribe('foo', function() {
        firstReceived = true;
    });
    ok(result);

    result = tincan.subscribe('foo', function() {
        secondReceived = true;
    });
    ok(result);

    tincan.publish('foo');
    ok(firstReceived);
    ok(secondReceived);
});

test('subscribe with context', function() {
    var obj = {
        received: false
    };

    tincan.subscribe('foo', function() {
        this.received = true;
    }, obj);

    ok(!obj.received);
    tincan.publish('foo');
    ok(obj.received);
});

</script>
</head>
<body>
    <h1 id="qunit-header">tincan.js tests</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
</body>
</html>
